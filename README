Quiz Web Service repo layout
============================

doc/        - API documentation (you need sphinx to build HTML).
misc/       - Tools, initial db data and internals documentation.
test-data/  - Local configurations and other files.
              This folder is not included to the repo and
              used only for testing on local host.
tests/      - Quiz Web service backend tests & test tools.
web/        - Quiz Web Service frontend.
wsg/        - Quiz Web Service backend.


OpenShift hooks (scripts)
-------------------------

.openshift/action_hooks/build       - Run every git push as part of the build process.
.openshift/action_hooks/deploy      - Run every git push after build but before the app is restarted.
.openshift/action_hooks/post_deploy - Run every git push after the app is restarted.
.openshift/action_hooks/pre_build   - Run every git push before the build.
.openshift/action_hooks/start       - Run to start the app.
.openshift/action_hooks/stop        - Run to stop the app.

Note: Every time you push, everything in your remote repo dir gets recreated
      please store long term items (like an sqlite database) in the OpenShift
      data directory, which will persist between pushes of your repo.
      The OpenShift data directory is accessible relative to the remote repo
      directory (../data) or using a path constructed as
      $OPENSHIFT_HOMEDIR/app-root/data.


OpenShift Application setup
===========================

Quiz Web Service runs in a python-2.7 DIY cartridge.
This section provides steps to setup such DIY cartridge.


* Create an app:
  rhc app create -a quizplatform -t diy-0.1

* Add cartridges:
  rhc cartridge add mysql-5.1 -a quizplatform
  rhc cartridge add cron-1.4 -a quizplatform

* Setup OpenShift hooks:
  .openshift/action_hooks/build
  .openshift/action_hooks/pre_build
  .openshift/action_hooks/stop
  .openshift/action_hooks/start

* Setup OpenShift cron tasks:
  .openshift/cron/daily/del_old_session
  .openshift/cron/monthly/dbclean
  .openshift/cron/daily/dbupdate
  .openshift/cron/weekly/rotatelogs

* Edit configs if you need:
  * $OPENSHIFT_DATA_DIR/quiz/uwsgi.ini - backend server config
  * $OPENSHIFT_DATA_DIR/quiz/config.ini - backend config
  * $OPENSHIFT_DATA_DIR/quiz/nginx.conf - nginx config

* Setup quiz database with dbsetup tool
  cd $OPENSHIFT_REPO_DIR
  $OPENSHIFT_DATA_DIR/bin/python misc/dbinit.py -n -c misc/config.ini
