
OpenShift application fresh setup HOWTO:
1) Create an app
rhc app create -a quizplatformtest -t diy-0.1

2) MySql
rhc cartridge add mysql-5.1

3) Edit .openshift/action_hooks

--- .openshift/action_hooks/stop ---
#!/bin/bash
if [  -f $OPENSHIFT_TMP_DIR/uswgi.pid ]; then
kill -INT `cat $OPENSHIFT_TMP_DIR/uwsgi.pid`
fi

--- .openshift/action_hooks/pre_build ---
#!/bin/bash
if [ ! -d $OPENSHIFT_DATA_DIR/bin ]; then
mkdir $OPENSHIFT_DATA_DIR/quiz
cp $OPENSHIFT_REPO_DIR/misc/config.ini $OPENSHIFT_DATA_DIR/quiz
fi

if [ ! -d $OPENSHIFT_DATA_DIR/bin ]; then

# install python 2.7.3 on builder gear
cd $OPENSHIFT_TMP_DIR
wget http://python.org/ftp/python/2.7.3/Python-2.7.3.tar.bz2
tar jxf Python-2.7.3.tar.bz2
cd Python-2.7.3
./configure --prefix=$OPENSHIFT_DATA_DIR
make install

export PATH=$OPENSHIFT_DATA_DIR/bin:$PATH

# install setuptools
cd $OPENSHIFT_TMP_DIR
wget http://pypi.python.org/packages/source/s/setuptools/setuptools-0.6c11.tar.gz
tar zxf setuptools-0.6c11.tar.gz
cd setuptools-0.6c11
python setup.py install

# install pip
cd $OPENSHIFT_TMP_DIR
wget http://pypi.python.org/packages/source/p/pip/pip-1.1.tar.gz
tar zxf pip-1.1.tar.gz
cd pip-1.1
python setup.py install

# install uWSGI
cd $OPENSHIFT_TMP_DIR
pip install uwsgi

# cleanup
cd $OPENSHIFT_TMP_DIR
rm -rf Python-2.7.3.tar.bz2
rm -rf setuptools-0.6c11.tar.gz
rm -rf pip-1.1.tar.gz

fi

4) configure other hooks hooks
--- .openshift/action_hooks/build ---
$OPENSHIFT_DATA_DIR/bin/pip install --use-mirrors -r $OPENSHIFT_REPO_DIR/requirements.txt

--- .openshift/action_hooks/start ---
$OPENSHIFT_DATA_DIR/bin/uwsgi -s $OPENSHIFT_INTERNAL_IP:$OPENSHIFT_INTERNAL_PORT --socket-protocol http --pp $OPENSHIFT_REPO_DIR/diy --module application -d $OPENSHIFT_DIY_LOG_DIR/app.log --pidfile $OPENSHIFT_TMP_DIR/uwsgi.pid
or
$OPENSHIFT_DATA_DIR/bin/uwsgi -L --master --process 2 -s $OPENSHIFT_INTERNAL_IP:$OPENSHIFT_INTERNAL_PORT --socket-protocol http --pp $OPENSHIFT_REPO_DIR/wsgi -w service:app -d $OPENSHIFT_DIY_LOG_DIR/app.log --pidfile $OPENSHIFT_TMP_DIR/uwsgi.pid

5)
cd $OPENSHIFT_REPO_DIR
$OPENSHIFT_DATA_DIR/bin/python misc/dbsetup.py
